<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>vueä¸­çš„diffç®—æ³•å®ç°</title>
  
  <link rel="canonical" href="https://slc3a2.github.io/2020/11/05/vue%E4%B8%AD%E7%9A%84diff%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/">
  
  <meta name="description" content="diff ç®—æ³• å’Œ virtual dom åœ¨ç°ä»£ mvvm æ¡†æ¶ react å’Œ vue ä¸­ï¼Œå› ä¸ºç›´æ¥æ“ä½œ dom ç›¸å¯¹æ˜¯è¦è€—è´¹æ›´å¤šæ€§èƒ½çš„ï¼Œæ‰€ä»¥ react å’Œ vue éƒ½ä½¿ç”¨äº† virtual dom æ¥æ›¿ä»£å¤„ç† domï¼Œå¤§è‡´çš„è¿‡ç¨‹æ˜¯ï¼šæŒ‰ç…§ dom ç»“æ„ç”Ÿæˆä¸€ä»½ virtual dom ä¸ºå¯¹è±¡ç»“">
  
  
  <meta name="author" content="slc3a2">
  
  <meta property="og:image" content="https://slc3a2.github.ioundefined">
  
  <meta property="og:site_name" content="slc3a2&#39;s blog" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="vueä¸­çš„diffç®—æ³•å®ç°" />
  
  <meta property="og:description" content="diff ç®—æ³• å’Œ virtual dom åœ¨ç°ä»£ mvvm æ¡†æ¶ react å’Œ vue ä¸­ï¼Œå› ä¸ºç›´æ¥æ“ä½œ dom ç›¸å¯¹æ˜¯è¦è€—è´¹æ›´å¤šæ€§èƒ½çš„ï¼Œæ‰€ä»¥ react å’Œ vue éƒ½ä½¿ç”¨äº† virtual dom æ¥æ›¿ä»£å¤„ç† domï¼Œå¤§è‡´çš„è¿‡ç¨‹æ˜¯ï¼šæŒ‰ç…§ dom ç»“æ„ç”Ÿæˆä¸€ä»½ virtual dom ä¸ºå¯¹è±¡ç»“">
  
  <meta property="og:url" content="https://slc3a2.github.io/2020/11/05/vue%E4%B8%AD%E7%9A%84diff%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="vueä¸­çš„diffç®—æ³•å®ç°">
  
  <meta name="twitter:description" content="diff ç®—æ³• å’Œ virtual dom åœ¨ç°ä»£ mvvm æ¡†æ¶ react å’Œ vue ä¸­ï¼Œå› ä¸ºç›´æ¥æ“ä½œ dom ç›¸å¯¹æ˜¯è¦è€—è´¹æ›´å¤šæ€§èƒ½çš„ï¼Œæ‰€ä»¥ react å’Œ vue éƒ½ä½¿ç”¨äº† virtual dom æ¥æ›¿ä»£å¤„ç† domï¼Œå¤§è‡´çš„è¿‡ç¨‹æ˜¯ï¼šæŒ‰ç…§ dom ç»“æ„ç”Ÿæˆä¸€ä»½ virtual dom ä¸ºå¯¹è±¡ç»“">
  
  
  <meta name="twitter:image" content="https://slc3a2.github.ioundefined">
  
  <meta name="twitter:url" content="https://slc3a2.github.io/2020/11/05/vue%E4%B8%AD%E7%9A%84diff%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="../fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="../fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-52Y2B2P1QW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-52Y2B2P1QW');
  </script>


<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒš</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>ğŸŒ</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      â¬… Click Here
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
          
          <a href="/application" class="ml">Application</a>
          
        
          
          <a href="/sponsor" class="ml">Sponsor</a>
          
        
        
          
            <a href="mailto:slc3a2@gmail.com" target="_blank" class="ml">Email</a>
          
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
          <h1>vueä¸­çš„diffç®—æ³•å®ç°</h1>

 
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <h2 id="diff-ç®—æ³•-å’Œ-virtual-dom"><a href="#diff-ç®—æ³•-å’Œ-virtual-dom" class="headerlink" title="diff ç®—æ³• å’Œ virtual dom"></a>diff ç®—æ³• å’Œ virtual dom</h2><p><img src="/2020/11/05/vue%E4%B8%AD%E7%9A%84diff%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/HrGjhDp8ebSt62R.png" alt="WechatIMG3177.png"></p>
<p>åœ¨ç°ä»£ <code>mvvm</code> æ¡†æ¶ <code>react</code> å’Œ <code>vue</code> ä¸­ï¼Œå› ä¸ºç›´æ¥æ“ä½œ dom ç›¸å¯¹æ˜¯è¦è€—è´¹æ›´å¤šæ€§èƒ½çš„ï¼Œæ‰€ä»¥ <code>react</code> å’Œ <code>vue</code> éƒ½ä½¿ç”¨äº† <code>virtual dom</code> æ¥æ›¿ä»£å¤„ç† domï¼Œå¤§è‡´çš„è¿‡ç¨‹æ˜¯ï¼šæŒ‰ç…§ dom ç»“æ„ç”Ÿæˆä¸€ä»½ <code>virtual dom</code> ä¸ºå¯¹è±¡ç»“æ„ã€‚å¦‚æœæ•°æ®æœ‰æ›´æ–°ï¼Œéœ€è¦è¡¨ç°åœ¨ dom ä¸Šï¼Œé‚£ä¹ˆå…ˆæŠŠå˜åŒ–è¡¨ç°åœ¨ <code>virtual dom</code>ï¼Œå†é€šè¿‡ <code>diff</code> ç®—æ³•æ¯”å¯¹æ•°æ®æ›´æ–°å‰åä¸¤æ¬¡ <code>virtual dom</code> æ‰¾åˆ°å·®åˆ«ã€‚æœ€åæŠŠä»…ä»…æ”¹å˜çš„è¿™éƒ¨åˆ†æ›´æ–°åˆ° dom ä¸Šï¼Œä¸ç”¨é‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢ã€‚</p>
<p>æ€»ç»“ï¼š<code>diff</code> ç®—æ³•å°±æ˜¯æ‰¾åˆ°ä¸¤ä¸ª <code>virtual dom</code> æ ‘ç»“æ„çš„ä¸åŒ</p>
<h2 id="diff-åŸç†"><a href="#diff-åŸç†" class="headerlink" title="diff åŸç†"></a>diff åŸç†</h2><p>é¦–å…ˆä¼ å…¥æ–°æ—§ <code>vnode</code> åˆ° <code>patch</code> å‡½æ•°å¼€å§‹æ¯”è¾ƒ:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœä¸¤ä¸ªvnodeå€¼å¾—æ¯”è¾ƒï¼Œè°ƒç”¨patchVnode</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> oEl <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el<span class="token punctuation">;</span> <span class="token comment">// oldVnode.elä¸ºå¯¹åº”çš„çœŸå®domå…ƒç´ </span>
    <span class="token keyword">let</span> parentEle <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">parentNode</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‰ç…§vnodeç»“æ„åˆ›å»ºçœŸå®domæ’å…¥çˆ¶å…ƒç´ ï¼Œç›´æ¥æ›¿æ¢oldVnode</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parentEle <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      api<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldVnode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> vnode<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¦–å…ˆä½¿ç”¨ <code>sameVnode</code> æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ª <code>vnode</code> æ˜¯å¦å€¼å¾—æ¯”è¾ƒï¼Œä»£ç å¦‚ä¸‹</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">sameVnode</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">//  keyä»£è¡¨å½“å‰èŠ‚ç‚¹æ•°æ®çš„keyå±æ€§ï¼Œå¤§æ¦‚çš„æ„æ€å°±æ˜¯divå’Œspanä¸ºä¸åŒæ ‡ç­¾ã€‚p.class1å’Œp.class2ä¸ºä¸åŒæ ‡ç­¾</span>
  <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>key <span class="token operator">===</span> oldVnode<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>sel <span class="token operator">===</span> oldVnode<span class="token punctuation">.</span>sel<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€è‡´å°±æŒ‰ç…§ä¸Šæ­¥éª¤ï¼Œç»§ç»­å¾€ä¸‹å¤„ç†ã€‚æ‰§è¡Œ <code>patchVnode</code> æ–¹æ³•ï¼Œå¦‚ä¸ä¸€è‡´ï¼Œç›´æ¥ç”¨æ–°å…ƒç´  <strong>ç›´æ¥æ›¿æ¢</strong> åˆ°æ—§å…ƒç´ ã€‚</p>
<p>å¦‚æœä¸¤ä¸ª <code>vnode</code> å€¼å¾—æ¯”è¾ƒï¼Œè°ƒç”¨ <code>patchVnode</code>:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">patchVnode</span> <span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> vnode<span class="token punctuation">.</span>el <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el
    <span class="token keyword">let</span> i<span class="token punctuation">,</span> oldCh <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>children<span class="token punctuation">,</span> ch <span class="token operator">=</span> vnode<span class="token punctuation">.</span>children
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode <span class="token operator">===</span> vnode<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// å¼•ç”¨ç›¸åŒï¼Œå°±è¯´æ˜ç›¸åŒï¼Œç›´æ¥return</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    	 <span class="token comment">// å¦‚æœæœ‰æ–‡æœ¬å†…å®¹ï¼Œæ¯”è¾ƒï¼Œå¦‚æœä¸åŒç›´æ¥è®¾ç½®ï¼Œç”¨æ–°çš„æ›¿æ¢æ—§çš„æ–‡æœ¬</span>
        api<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">updateEle</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> oldVnode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&amp;&amp;</span> oldCh <span class="token operator">!==</span> ch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¦‚æœéƒ½æœ‰å­èŠ‚ç‚¹ï¼Œä¸”ä¸åŒï¼Œå¼€å§‹æ¯”è¾ƒå­èŠ‚ç‚¹</span>
            <span class="token function">updateChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        	  <span class="token comment">// å¦‚æœåªæœ‰æ–°vnodeä¸Šæœ‰å­èŠ‚ç‚¹ï¼Œç›´æ¥æ–°å»º</span>
            <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        	  <span class="token comment">// å¦‚æœæ–°vnodeæ²¡å­å­èŠ‚ï¼Œè€Œè€vnodeæœ‰ï¼Œåˆ™åˆ é™¤è€èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</span>
            api<span class="token punctuation">.</span><span class="token function">removeChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœéƒ½æœ‰å­èŠ‚ç‚¹ï¼Œä¸”ä¸åŒï¼Œå¼€å§‹æ¯”è¾ƒå­èŠ‚ç‚¹ï¼Œè°ƒç”¨ <code>updateChildren</code> å‡½æ•°å¼€å§‹æ¯”è¾ƒå­èŠ‚ç‚¹:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">updateChildren</span> <span class="token punctuation">(</span><span class="token parameter">parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> newCh</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// parentElmï¼šçœŸæ˜¯domèŠ‚ç‚¹ã€‚oldChï¼šè€vnodeçš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚newChï¼šæ–°vnodeçš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚</span>
	 <span class="token comment">// é€šè¿‡ä¸‹æ ‡ï¼Œè®¾ç½®æ–°æ—§vnodeçš„å‰åä¸¤ä¸ªå…ƒç´ ï¼Œ</span>
    <span class="token keyword">let</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIdx<span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx<span class="token punctuation">]</span>
   	 <span class="token comment">// è®¾ç½®ä¸€äº›æ¯”è¾ƒè¿‡ç¨‹éœ€è¦çš„å˜é‡</span>
    <span class="token keyword">let</span> oldKeyToIdx
    <span class="token keyword">let</span> idxInOld
    <span class="token keyword">let</span> elmToMove
    <span class="token keyword">let</span> before
    <span class="token comment">// ä¸¤å¯¹èŠ‚ç‚¹ï¼Œåˆ†åˆ«ä»å¤´å’Œå°¾å‘ä¸­é—´å¾ªç¯é æ‹¢ä¾æ¬¡æ¯”å¯¹ï¼Œå¦‚æœèµ·å§‹ä¸‹æ ‡å¤§äºç»“å°¾ä¸‹æ ‡ï¼Œè¯æ˜æ¯”å¯¹ç»“æŸï¼Œä½œä¸ºå¾ªç¯ç»“æŸæ¡ä»¶</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&lt;=</span> oldEndIdx <span class="token operator">&amp;&amp;</span> newStartIdx <span class="token operator">&lt;=</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token comment">//å¯¹äºvnode.keyçš„æ¯”è¾ƒï¼Œä¼šæŠŠoldVnode = null</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
                api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">)</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
               <span class="token comment">// ä½¿ç”¨keyæ—¶çš„æ¯”è¾ƒ</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>oldKeyToIdx <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    oldKeyToIdx <span class="token operator">=</span> <span class="token function">createKeyToOldIdx</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span> <span class="token comment">// æœ‰keyç”Ÿæˆindexè¡¨</span>
                <span class="token punctuation">&#125;</span>
                idxInOld <span class="token operator">=</span> oldKeyToIdx<span class="token punctuation">[</span>newStartVnode<span class="token punctuation">.</span>key<span class="token punctuation">]</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>idxInOld<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                    elmToMove <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>elmToMove<span class="token punctuation">.</span>sel <span class="token operator">!==</span> newStartVnode<span class="token punctuation">.</span>sel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                        <span class="token function">patchVnode</span><span class="token punctuation">(</span>elmToMove<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                        oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
                        api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> elmToMove<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    <span class="token punctuation">&#125;</span>
                    newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">></span> oldEndIdx<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            before <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>el
            <span class="token function">addVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> before<span class="token punctuation">,</span> newCh<span class="token punctuation">,</span> newStartIdx<span class="token punctuation">,</span> newEndIdx<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartIdx <span class="token operator">></span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">removeVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ€»ç»“ï¼š</p>
<ul>
<li><p><strong>è°ƒç”¨ patch</strong>ï¼šä¼ å…¥ <code>æ–°æ—§vnode</code>ï¼Œè°ƒç”¨ <code>sameVnode</code>ï¼Œè¿”å› <code>true</code> è¯´æ˜å€¼å¾—æ¯”è¾ƒï¼Œåˆ™è°ƒç”¨ <code>patchVnode</code>ï¼Œå¦åˆ™ç›´æ¥ä½¿ç”¨æ–°èŠ‚ç‚¹æ›¿æ¢æ—§èŠ‚ç‚¹</p>
</li>
<li><p><strong>è°ƒç”¨ patchVnode</strong>ï¼šæ›´è¯¦ç»†çš„å¯¹æ¯”æ–°æ—§ vnodeï¼Œåˆ†å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>1: å¯¹äºæ–°æ—§ vnode çš„.el çœŸå® dom å±æ€§ï¼Œå¹¶å¯¹æ¯”ï¼Œå¦‚æœ===é‚£å°±è¯æ˜æ˜¯åŒä¸€ä¸ªï¼Œç›´æ¥ return</li>
<li>2: å¦‚æœå­˜åœ¨æ–‡æœ¬èŠ‚ç‚¹ï¼Œç›´æ¥ç”¨æ–° vnode å†…æ–‡æœ¬æ›¿æ¢æ—§ vnode æ–‡æœ¬</li>
<li>3: åˆ¤æ–­å­èŠ‚ç‚¹ï¼Œå¦‚æœæ–° vnode æœ‰ï¼Œæ—§ vnode æ²¡æœ‰ï¼Œåˆ™ç›´æ¥æŠŠæ–° vnode çš„å­èŠ‚ç‚¹åŠ å…¥åˆ°çœŸå® domï¼Œç›¸åå°±åˆ é™¤æ‰çœŸå® dom å­èŠ‚ç‚¹</li>
<li>4: å¦‚æœéƒ½æœ‰å­èŠ‚ç‚¹ï¼Œä¸”ä¸åŒï¼Œè°ƒç”¨ updateChildrenï¼Œè¯¦ç»†å¯¹æ¯”</li>
</ul>
</li>
<li><p><strong>è°ƒç”¨ updateChildren</strong>ï¼š ä»ä¸¤è¾¹å‘ä¸­é—´æ”¶æ‹¢å¾ªç¯ä¸¤ä¸ªæ–°æ—§ vnode çš„æ¯ä¸ªå­èŠ‚ç‚¹ï¼Œä»¥æ­¤å¯¹æ¯”ï¼Œå¤´å¤´ï¼Œå°¾å°¾ï¼Œå¤´å°¾ï¼Œå°¾å¤´ã€‚å¦‚æœè¿™å››ç§æ¯”å¯¹è°ƒç”¨ sameVnodeï¼Œå¾—åˆ° trueï¼Œè¯æ˜å€¼å¾—å¯¹æ¯”ï¼Œé‚£ä¹ˆå°±è°ƒç”¨ç¬¬äºŒæ­¥éª¤çš„ <code>patchVnode</code> é€’å½’ç»§ç»­æ¯”ï¼Œé™¤äº†è¿™å››ç§æƒ…å†µã€‚å¦‚æœæœ‰ keyï¼Œåˆ™ä¼šå¯¹æ¯” keyã€‚å¦åˆ™ç›´æ¥æ›¿æ¢æ–°å…ƒç´ åˆ°çœŸå® domã€‚</p>
</li>
</ul>


<p style="font-style: italic">
  <!-- <a class="classtest-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">å‰ç«¯</a>  -->
  <!-- 2020å¹´11æœˆ5æ—¥ -->
  <a class="classtest-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">å‰ç«¯</a> Â· 2020å¹´11æœˆ5æ—¥ Â· è¢«æµè§ˆ
  <span id="busuanzi_value_page_pv">-</span> æ¬¡
</p>




          <div class="row mt-2">
  
  <div class="eight columns">
    <p id="madewith">
      Made with
      <a
        class="footer-link icon"
        href="https://hexo.io"
        target="_blank"
        style="text-decoration: none"
        rel="noreferrer"
        aria-label="Hexo.io"
      >
        <svg
          class="hexo svg-hov"
          width="14"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
        >
          <title>Hexo.js</title>
          <path
            d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"
          />
        </svg>
      </a>
      <!-- 
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
         -->
      <!-- <p style="font-style:italic; font-size: 14px;">
          PV <span id="busuanzi_value_site_pv"></span>
          UV <span id="busuanzi_value_site_uv"></span>
        </p> -->
    </p>
  </div>

  <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
  <div class="four columns mb-3 posisi">
    
    <a
      class="ml-0 footer-link icon"
      href="https://github.com/slc3a2"
      target="_blank"
      style="text-decoration: none"
      rel="noreferrer"
      aria-label="GitHub"
    >
      <svg
        class="github svg-hov"
        width="18"
        role="img"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <title>GitHub</title>
        <path
          d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
        />
      </svg>
    </a>
        
    <a
      class="ml-0 footer-link icon"
      href="https://leetcode.cn/u/slc3a2"
      target="_blank"
      style="text-decoration: none"
      rel="noreferrer"
      aria-label="StackOverflow"
    >
      <svg
        class="stackoverflow svg-hov"
        width="18"
        role="img"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <title>Stack Overflow</title>
        <path
          d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.133v2.13h10.66v-2.13H6.154Z"
        />
      </svg>
    </a>
    
    <script
      async
      src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
    ></script>
  </div>
  
</div>

        </div>
      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>
  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>
